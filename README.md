# VBA-challenge
UTOR-VIRT-DATA-PT-04-2023-U-LOLC
## Stocks Data Summary Analysis
### Part A: Creating Tables for Summary Statistics
To start, all variables were declared (variable assignment was embedded in the code as need arose). All worksheets were going to be undergoing the same sequence of code; therefore, looping through the worksheets started from the beginning (i.e., creating tables) and ended at the very end (i.e., finding noteworthy stocks).
Two tables were created using simple references to specific cells in each worksheet. One table for Stock Summary Statistics, and one table for Noteworthy Stocks per worksheet. 
### Part B: Assigning values to Summary Statistics Table
A forloop was generated to loop through raw data, and pull out valuable information including **ticker**, **yearly change**, **percent change**, and **total stock volume**. The **ticker** was obtained using a conditional if/then statement where when the value in one cell did not equal the value in the following cell, a new ticker was added to the list. In this same loop, the initial opening value (for all except the first, which was assigned individually) ticker was obtained along with the final closing value. The difference of the two values (closing - opening) provided the **yearly change**. This value was added to the "yearly change" column of the Summary Statistics Table. Further, the **percent change** was obtained by dividing the difference by the initial opening value and multiplying by 100 (i.e., ((closing - opening) / opening ) * 100). However, for any stocks with an opening value of 0, the default was set to 0% change using if statements. Finally, the **total stock volume** values were generated by summing up all values with same ticker name using the forloop. As the forloop iterated through each row, the stock volume was added to a variable called "total_stock_volume" that held the sum of the stock volume for that particular ticker. When a new ticker was detected, the variable was set to 0. 
### Part 3: Formatting Summary Statistics Table
Three columns were formatted in the Summary Statistics Table. They are: the **yearly change**, the **percent change**, and the **total stock volume** columns. The **yearly change** column was formatted first to show only two decimal places. Then, through conditional formatting, values greater than or equal to zero were given an interior color of green, which values less than zero were given an interior color of red using color indexes. The **percent change** column was formatted first to show two decimal places and a "%" sign at the end. Second, through conditional formatting, values greater than and equal to zero were assigned a green font, while values less than zero were assigned a red font. Finally, the **total stock volume** column was formatted simply into comma separated values.
### Noteworthy Stocks Table
What makes a stock noteworthy? Stocks with the greatest percent increase, the greatest percent decrease, and the greatest total stock volume might allow analysts to determine contributers to stock success and failure. In this dataset, these values were calculated per year. Stocks corresponding to greatest percent increase, greatest percent decrease, and greatest total volume were found through the worksheet functions max, min, and max respectively. These values were then formatted similarly to the Summary Statistics Table and the corresponding ticker was obtained through the Index and Match Function.
